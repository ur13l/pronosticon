extends /layouts/app

block scripts
    script(src= url('/js/quinielas/editar.js'))

block title
    title= quiniela.nombre
    
block content
    input(type="hidden" id="_id_quiniela" name="_id_quiniela" value=quiniela.id)
    div.banner.row
        img.banner_img(src=quiniela.imagen)
        div.banner_mask
        h1.banner_title.white-color-text.center= quiniela.nombre
    div.container.white-background
        ul.breadcrumb
            li 
                a(href=url('/')) Inicio
            li
                a(href=url('/quinielas/')) Quinielas
            li
                a.active(href=url('/quinielas/editar/' + quiniela.id))= quiniela.nombre
    
        br
        div.row
            div.four.columns.center 
                h4 Participantes
                if count(quiniela.participacions) == 0
                    h6 No hay participantes registrados
                else
                    if quiniela.tipoQuiniela.nombre != "Survivor"
                        table.ten.columns.offset-by-one
                            thead
                                tr
                                    th #
                                    th Nombre
                                    th Pts.
                            tbody
                                each p, key in quiniela.participacions
                                    tr
                                        td= key + 1
                                        td= p.usuario.nombre
                                        td= p.puntuacion

                    else
                        table.ten.columns.offset-by-one
                            thead
                                tr
                                    th Activo
                                    th Nombre
                                    th 
                                    th
                            tbody
                                each p, key in quiniela.participacionesSurvivor
                                    tr
                                        td
                                            if p.activo
                                                img(src=url('img/success.png') height="24")
                                            else
                                                img(src=url('img/cancel.png') height="24")
                                        td= p.usuario.nombre
                                        td= p.ultimoPronostico.equipoGanador.nombre

                h6 Agregar participante
                form(action=url('/quinielas/agregarparticipante') method="post" id="form_agregar_participante")
                    input(type="hidden" name="_token" value=csrf_token())
                    div.ui-widget
                        input.ten.columns.offset-by-one(type="text" placeholder="Introduzca el nombre " id="id_usuario_autocomplete" name="id_usuario_autocomplete")
                        input(type="hidden" id="id_usuario" name="id_usuario")
                        input(type="hidden" name="id_quiniela" value=quiniela.id)
                div.space
                
            div.four.columns.center
                div.row
                    h4 Próxima jornada
                    if count(quiniela.liga.proximaJornada.partidos) == 0
                        h6 No hay jornadas registradas
                    else
                        table.ten.columns.offset-by-one
                            thead
                                tr
                                    th.center(colspan=3)= quiniela.liga.proximaJornada.nombre
                            tbody
                                each partido in quiniela.liga.proximaJornada.partidos
                                    tr
                                        td.center
                                            img(src=url('/storage/' +partido.equipoLocal.imagen) height="50")
                                        td.center vs
                                        td.center
                                            img(src=url('/storage/' +partido.equipoVisita.imagen) height="50")
                        if quiniela.liga.proximaJornada != null
                            button.ten.columns.offset-by-one.primary-color-background(onclick="location.href='"+ url('/jornadas/editar/partidos/' + quiniela.liga.proximaJornada.id) +"?from=" + quiniela.id + "'")
                                | Editar partidos
                br
                div.row
                    h4 Última jornada
                    if count(quiniela.liga.ultimaJornada.partidos) == 0
                        h6 No hay jornadas registradas
                    else
                        table.ten.columns.offset-by-one
                            thead
                                tr
                                    th.center(colspan="3")= quiniela.liga.ultimaJornada.nombre
                            tbody
                                each partido in quiniela.liga.ultimaJornada.partidos
                                    tr
                                        td.center
                                            img(src=url('/storage/' + partido.equipoLocal.imagen) height="50")
                                        if quiniela.liga.ultimaJornada.registrada
                                            td.center 
                                               | #{partido.resultados.first().resultado_local} - #{partido.resultados.first().resultado_visita}
                                        else
                                            td.center vs
                                        td.center
                                            img(src=url('/storage/' + partido.equipoVisita.imagen) height="50")
                        
                    if quiniela.liga.ultimaJornada != null
                        button.ten.columns.offset-by-one.primary-color-background(onclick="location.href='"+ url('/jornadas/editar/resultados/' + quiniela.liga.ultimaJornada.id) +"?from=" + quiniela.id + "'")
                            | Actualizar resultados
                div.space
            div.four.columns.center 
                form(action=url('/quinielas/actualizarbolsa') id="form_actualizar_bolsa" method="post")
                    h4 Bolsa
                    input(type="hidden" name="_token" value=csrf_token())
                    input(type="hidden" name="id_quiniela" value=quiniela.id)
                    each bolsa, key in quiniela.bolsas
                        input(type="hidden" name="id_bolsa[]" value=bolsa.id)
                        label(for="bolsa#{key + 1}") Premio ##{key + 1}
                        input.ten.columns.offset-by-one.center(type="number" placeholder="$" id="bolsa#{key + 1}" name="cantidad[]" value=bolsa.cantidad)
                    div.small-space
                    button.ten.columns.offset-by-one.primary-color-background(type="submit")
                            | Actualizar 
                div.space
            
